<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>Create New Note</title>
        <link rel="icon" href="./icon.png" type="image/x-icon">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

        <title>Create New Note</title>
        <meta charset="utf-8">
        <meta name="description" content="Write something down for later">
        <meta name="keywords" content="tool,link,link shortener,free,stateless,safe">

        <meta property="og:title" content="Create New Note">
        <meta property="og:description" content="Write something down for later">
        <meta property="og:site_name" content="Sticky Note">
        <meta property="og:url" content="snailien.net">
        <meta property="og:image" content="./icon.png">

        <meta itemprop="name" content="Create New Note">
        <meta itemprop="description" content="Write something down for later">
        <meta itemprop="image" content="./icon.png">

        <meta name="twitter:card" content="Write something down for later">
        <meta name="twitter:url" content="snailien.net">
        <meta name="twitter:title" content="Create New Note">
        <meta name="twitter:description" content="Write something down for later">
        <meta name="twitter:image" content="./icon.png">

        <style>
            .mobileSize * {
                height: 10vh;
                min-width: 45vw;
                font-size: 5vmin;
            }
        </style>

    </head>
    <body style="background-color: #2c2e36; color: #f5f5f5;">
        <h1>Sticky Note</h1>
        <i>Write down info for later.</i><br>
        <i>If you are someone other than the creator of this app, <b>you shouldn't be using this!</b></i>
        <hr>

        <form action="./writer.php" method="POST" class="mobileSize">

            <label for="type">Record Type:</label>
            <select id="type" name="TYPE">
                <option value="unset">Please select...</option>
                <option value="note_other">Misc Note</option>
                <option value="data_other">Misc Data</option>
                <option value="data_bm">Necessary Evil</option>
            </select>
            <br><br>

            <label for="tags">Type Tags:</label>
            <input type="text" id="tags" name="TAGS">
            <br>

            <br>

            <label for="payload1">Data 1:</label>
            <textarea id="payload1" name="PAYLOAD1"></textarea>
            <br>
            <label for="payload2">Data 2:</label>
            <textarea id="payload2" name="PAYLOAD2"></textarea>
            <br>
            <label for="payload3">Data 3:</label>
            <textarea id="payload3" name="PAYLOAD3"></textarea>
            <br>
            <label for="payload4">Data 4:</label>
            <textarea id="payload4" name="PAYLOAD4"></textarea>
            <br>
            <label for="payload5">Data 5:</label>
            <textarea id="payload5" name="PAYLOAD5"></textarea>
            <br>
    
            <br>

            <label for="strength">Priority / Importance:</label>
            <select id="strength" name="IMPORTANCE">
                <option value="-1">Please select...</option>
                <option value="0">None</option>
                <option value="1">Low</option>
                <option value="2">Medium</option>
                <option value="3">High</option>
            </select>
            <br><br>

            <label for="ephemeral">Ephemeral:</label>
            <select id="ephemeral" name="DELETABLE">
                <option value=false>This data should persist</option>
                <option value=true>This data is only useful short-term</option>
            </select>
            <br><br>

            <label for="time">Current Timestamp:</label>
            <input type="datetime-local" id="time" name="SELECTED_TIME">
            <br><br>

            <label for="position_latitude">Current Latitude:</label>
            <input type="text" id="position_latitude" name="POSITION_LATITUDE" readonly>
            <br><br>
            <label for="position_longitude">Current Longitude:</label>
            <input type="text" id="position_longitude" name="POSITION_LONGITUDE" readonly>
            <br><br>
            

            <button type="submit">Submit</button>
        </form>
            


        <script>
            function getLocation() {
                if ("geolocation" in navigator) {
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            document.getElementById("position_latitude").value = position.coords.latitude;
                            document.getElementById("position_longitude").value = position.coords.longitude;
                        },
                        error => {
                            console.error("Error getting location:", error)
                            document.getElementById("position_latitude").value = "ERROR";
                            document.getElementById("position_longitude").value = "ERROR";
                        }
                    );
                }
            }
            getLocation();

            function getTimestamp() // get the current DateTime (in local timezone) and write it to the time <input>
            {
                var offset = new Date().getTimezoneOffset()*60*1000; // value given is in minutes, convert to milliseconds
                var ts = new Date(Date.now() - offset);
                var ts = ts.toISOString();
                console.log(ts);
                ts = ts.substring(0, ts.length - 8);
                document.getElementById("time").value = ts;
            }
            getTimestamp();
        </script>
        

        

        <script type="module">
            window.redirectBaseURL = "https://tools.snailien.net/LinkShortener/unpack.php";

            import { Compressor } from "./compressor.js";
            var c = new Compressor();
            window.main = c;

            document.getElementById('input').addEventListener('input', function() 
            {
                document.getElementById('output').value = window.redirectBaseURL + window.main.push(document.getElementById('input').value);
                document.getElementById('inputLength').value = document.getElementById('input').value.length;
                document.getElementById('outputLength').value = document.getElementById('output').value.length;
            });
        </script>
    </body>
</html>
